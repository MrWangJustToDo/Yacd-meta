import{r as E,R as m,p,c as se,j as t,q as ae,s as A,t as V,v as re,w as G,b as H,x as le,g as J,y as oe,u as ie,z as ce,A as _,D as de,E as ue,F as me,G as he,H as pe,J as ve,K as xe,C as fe,S as C,B as j,L as je,N as ge,O as be}from"./index-864353ba.js";import{r as ye}from"./logs-665e81fd.js";import{S as b}from"./Select-db61b685.js";import{I as O,S as we}from"./Input-c5d9d541.js";import{R as N}from"./rotate-cw-72e5bcb7.js";function P(){return P=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var r=arguments[l];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},P.apply(this,arguments)}function ke(e,l){if(e==null)return{};var r=_e(e,l),s,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)s=a[n],!(l.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function _e(e,l){if(e==null)return{};var r={},s=Object.keys(e),n,a;for(a=0;a<s.length;a++)n=s[a],!(l.indexOf(n)>=0)&&(r[n]=e[n]);return r}var z=E.forwardRef(function(e,l){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,a=n===void 0?24:n,h=ke(e,["color","size"]);return m.createElement("svg",P({ref:l,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},h),m.createElement("polyline",{points:"8 17 12 21 16 17"}),m.createElement("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),m.createElement("path",{d:"M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"}))});z.propTypes={color:p.string,size:p.oneOfType([p.string,p.number])};z.displayName="DownloadCloud";const Ce=z;function I(){return I=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var r=arguments[l];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},I.apply(this,arguments)}function Oe(e,l){if(e==null)return{};var r=Ne(e,l),s,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)s=a[n],!(l.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Ne(e,l){if(e==null)return{};var r={},s=Object.keys(e),n,a;for(a=0;a<s.length;a++)n=s[a],!(l.indexOf(n)>=0)&&(r[n]=e[n]);return r}var T=E.forwardRef(function(e,l){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,a=n===void 0?24:n,h=Oe(e,["color","size"]);return m.createElement("svg",I({ref:l,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},h),m.createElement("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),m.createElement("polyline",{points:"16 17 21 12 16 7"}),m.createElement("line",{x1:"21",y1:"12",x2:"9",y2:"12"}))});T.propTypes={color:p.string,size:p.oneOfType([p.string,p.number])};T.displayName="LogOut";const Se=T;function L(){return L=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var r=arguments[l];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},L.apply(this,arguments)}function Pe(e,l){if(e==null)return{};var r=Ie(e,l),s,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)s=a[n],!(l.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Ie(e,l){if(e==null)return{};var r={},s=Object.keys(e),n,a;for(a=0;a<s.length;a++)n=s[a],!(l.indexOf(n)>=0)&&(r[n]=e[n]);return r}var R=E.forwardRef(function(e,l){var r=e.color,s=r===void 0?"currentColor":r,n=e.size,a=n===void 0?24:n,h=Pe(e,["color","size"]);return m.createElement("svg",L({ref:l,xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},h),m.createElement("polyline",{points:"3 6 5 6 21 6"}),m.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),m.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),m.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))});R.propTypes={color:p.string,size:p.oneOfType([p.string,p.number])};R.displayName="Trash2";const Le=R,Ee="_root_1vck5_4",ze="_section_1vck5_5",Te="_wrapSwitch_1vck5_30",Re="_sep_1vck5_36",$e="_label_1vck5_49",i={root:Ee,section:ze,wrapSwitch:Te,sep:Re,label:$e},Me="_fieldset_1hnn2_1",De="_input_1hnn2_10",Fe="_cnt_1hnn2_10",S={fieldset:Me,input:De,cnt:Fe};function We({OptionComponent:e,optionPropsList:l,selectedIndex:r,onChange:s}){const n=se("visually-hidden",S.input),a=h=>{s(h.target.value)};return t.jsx("fieldset",{className:S.fieldset,children:l.map((h,c)=>t.jsxs("label",{children:[t.jsx("input",{type:"radio",checked:r===c,name:"selection",value:c,"aria-labelledby":"traffic chart type "+c,onChange:a,className:n}),t.jsx("div",{className:S.cnt,children:t.jsx(e,{...h})})]},c))})}const{useMemo:Be}=G,Ue={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},q=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],Ae=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Ve=q;function Ge({id:e}){const l=ae.read(),r=Be(()=>({labels:Ve,datasets:[{...A,...V[e].up,data:q},{...A,...V[e].down,data:Ae}]}),[e]),s="chart-"+e;return re(l.Chart,s,r,null,Ue),t.jsx("div",{style:{width:80,padding:5},children:t.jsx("canvas",{id:s})})}const{useEffect:K,useState:He,useCallback:v,useRef:Je}=G,qe=[{id:0},{id:1},{id:2},{id:3}],Ke=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],Qe=[{key:"port",label:"Http Port"},{key:"socks-port",label:"Socks5 Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"mitm-port",label:"MITM Port"}],Xe=[["zh-cn","简体中文"],["zh-tw","繁體中文"],["en","English"],["vi","Vietnamese"]],Ye=[["direct","Direct"],["rule","Rule"],["script","Script"],["global","Global"]],Ze=[["gvisor","gVisor"],["mixed","Mixed"],["system","System"]],et=e=>({configs:le(e),apiConfig:J(e)}),tt=e=>({selectedChartStyleIndex:ge(e),latencyTestUrl:be(e),apiConfig:J(e)}),nt=H(tt)(rt),ut=H(et)(st);function st({dispatch:e,configs:l,apiConfig:r}){return K(()=>{e(oe(r))},[e,r]),t.jsx(nt,{configs:l})}function at(e){return e&&e.meta&&!e.premium?"Clash.Meta ":e&&e.meta&&e.premium?"sing-box ":"Clash Premium"}function rt({dispatch:e,configs:l,selectedChartStyleIndex:r,latencyTestUrl:s,apiConfig:n}){var F,W,B,U;const{t:a,i18n:h}=ie(),[c,y]=He(l),$=Je(l);K(()=>{$.current!==l&&y(l),$.current=l},[l]);const Q=v(()=>{e(ce("apiConfig"))},[e]),w=v((o,d)=>{y({...c,[o]:d})},[c]),M=v((o,d)=>{const x={...c.tun,[o]:d};y({...c,tun:{...x}})},[c]),f=v(({name:o,value:d})=>{switch(o){case"mode":case"log-level":case"allow-lan":case"sniffing":w(o,d),e(_(n,{[o]:d})),o==="log-level"&&ye({...n,logLevel:d});break;case"mitm-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(d!==""){const x=parseInt(d,10);if(x<0||x>65535)return}w(o,d);break;case"enable":case"stack":M(o,d),e(_(n,{tun:{[o]:d}}));break;default:return}},[n,e,w,M]),{selectChartStyleIndex:X,updateAppConfig:D}=de(),g=v(o=>{const{name:d,value:x}=o.target;switch(d){case"port":case"socks-port":case"mixed-port":case"redir-port":case"mitm-port":{const k=parseInt(x,10);if(k<0||k>65535)return;e(_(n,{[d]:k}));break}case"latencyTestUrl":{D(d,x);break}case"device name":case"interface name":break;default:throw new Error(`unknown input name ${d}`)}},[n,e,D]),Y=v(()=>{e(ue(n))},[n,e]),Z=v(()=>{e(me(n))},[n,e]),ee=v(()=>{e(he(n))},[n,e]),te=v(()=>{e(pe(n))},[n,e]),ne=v(()=>{e(ve(n))},[n,e]),{data:u}=xe(["/version",n],()=>je("/version",n));return t.jsxs("div",{children:[t.jsx(fe,{title:a("Config")}),t.jsxs("div",{className:i.root,children:[u.meta&&u.premium||Qe.map(o=>c[o.key]!==void 0?t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:o.label}),t.jsx(O,{name:o.key,value:c[o.key],onChange:({target:{name:d,value:x}})=>f({name:d,value:x}),onBlur:g})]},o.key):null),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Mode"}),t.jsx(b,{options:c["mode-list"]?c["mode-list"].map(o=>[o,o]):Ye,selected:c["mode-list"]?c.mode:c.mode.toLowerCase(),onChange:o=>f({name:"mode",value:o.target.value})})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Log Level"}),t.jsx(b,{options:Ke,selected:c["log-level"].toLowerCase(),onChange:o=>f({name:"log-level",value:o.target.value})})]}),u.meta&&u.premium||t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:a("allow_lan")}),t.jsx("div",{className:i.wrapSwitch,children:t.jsx(C,{name:"allow-lan",checked:c["allow-lan"],onChange:o=>f({name:"allow-lan",value:o})})})]}),u.meta&&!u.premium&&t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:a("tls_sniffing")}),t.jsx("div",{className:i.wrapSwitch,children:t.jsx(C,{name:"sniffing",checked:c.sniffing,onChange:o=>f({name:"sniffing",value:o})})})]})]}),t.jsx("div",{className:i.sep,children:t.jsx("div",{})}),u.meta&&t.jsxs(t.Fragment,{children:[u.premium||t.jsxs("div",{children:[t.jsxs("div",{className:i.section,children:[t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:a("enable_tun_device")}),t.jsx("div",{className:i.wrapSwitch,children:t.jsx(C,{checked:(F=c.tun)==null?void 0:F.enable,onChange:o=>f({name:"enable",value:o})})})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"TUN IP Stack"}),t.jsx(b,{options:Ze,selected:(B=(W=c.tun)==null?void 0:W.stack)==null?void 0:B.toLowerCase(),onChange:o=>f({name:"stack",value:o.target.value})})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Device Name"}),t.jsx(O,{name:"device name",value:(U=c.tun)==null?void 0:U.device,onChange:g})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Interface Name"}),t.jsx(O,{name:"interface name",value:c["interface-name"]||"",onChange:g})]})]}),t.jsx("div",{className:i.sep,children:t.jsx("div",{})})]}),t.jsxs("div",{className:i.section,children:[t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Reload"}),t.jsx(j,{start:t.jsx(N,{size:16}),label:a("reload_config_file"),onClick:Y})]}),u.meta&&!u.premium&&t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"GEO Databases"}),t.jsx(j,{start:t.jsx(Ce,{size:16}),label:a("update_geo_databases_file"),onClick:te})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"FakeIP"}),t.jsx(j,{start:t.jsx(Le,{size:16}),label:a("flush_fake_ip_pool"),onClick:ne})]}),u.meta&&!u.premium&&t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Restart"}),t.jsx(j,{start:t.jsx(N,{size:16}),label:a("restart_core"),onClick:Z})]}),u.meta&&!u.premium&&t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"⚠️ Upgrade ⚠️"}),t.jsx(j,{start:t.jsx(N,{size:16}),label:a("upgrade_core"),onClick:ee})]})]}),t.jsx("div",{className:i.sep,children:t.jsx("div",{})})]}),t.jsxs("div",{className:i.section,children:[t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:a("latency_test_url")}),t.jsx(we,{name:"latencyTestUrl",type:"text",value:s,onBlur:g})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:a("lang")}),t.jsx("div",{children:t.jsx(b,{options:Xe,selected:h.language,onChange:o=>h.changeLanguage(o.target.value)})})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:a("chart_style")}),t.jsx(We,{OptionComponent:Ge,optionPropsList:qe,selectedIndex:r,onChange:X})]}),t.jsxs("div",{children:[t.jsxs("div",{className:i.label,children:[a("current_backend"),t.jsx("p",{children:at(u)+(n==null?void 0:n.baseURL)})]}),t.jsx("div",{className:i.label,children:"Action"}),t.jsx(j,{start:t.jsx(Se,{size:16}),label:a("switch_backend"),onClick:Q})]})]})]})}export{ut as default};
